通常情况下服务消费方依赖服务提供方的接口jar包，然后直接通过@CloudReference注解即可从注册中心获取调用地址进行服务调用，服务调用时只要直接使用接口的方法即可。


### 服务jar包

#### pom

```xml
<dependencies>
    <dependency>
        <groupId>com.hundsun.jrescloud</groupId>
        <artifactId>jrescloud-starter-rpc-def</artifactId>
    </dependency>
    <dependency>
        <groupId>com.hundsun.jrescloud</groupId>
        <artifactId>jrescloud-starter</artifactId>
    </dependency>
</dependencies>
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>com.hundsun.jrescloud</groupId>
            <artifactId>jrescloud-dependencies</artifactId>
            <version>2.0.17</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>
```

#### 服务接口
jar包中只提供接口，接口内容由服务提供者实现
```java
@CloudService
public interface TestService {
    String test();
}
```

### 服务提供者

#### 导入jar包
```xml
<dependencies>
    <dependency>
        <groupId>com.hundsun</groupId>
        <artifactId>demo1-api</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>
</dependencies>
```


#### 实现服务接口

```java
@CloudComponent
public class TestServiceImpl implements TestService {
    public String test() {
        return "test";
    }
}
```

#### 启动类

```java
@CloudApplication
public class Provider {
    public static void main(String[] args) {
        CloudBootstrap.run(Provider.class,args);
    }
}
```

### 服务消费者

#### 导入jar包
```xml
<dependencies>
    <dependency>
        <groupId>com.hundsun</groupId>
        <artifactId>demo1-api</artifactId>
        <version>1.0-SNAPSHOT</version>
    </dependency>
</dependencies>
```

#### 调用服务

```java
@RestController
public class TestController {
    @CloudReference(targetUrl = "127.0.0.1:2181")
    private TestService testService;

    @RequestMapping("/test")
    public String test(){
        return testService.test();
    }
}
```
#### 启动类
```java
@CloudApplication
public class Consumer {
    public static void main(String[] args) {
        CloudBootstrap.run(Consumer.class, args);
    }
}
```

### 注册中心

jres的注册中心使用zookeeper(也可以不使用注册中心)，这里采用zookeeper注册中心

安装好zookeeper后执行zkServer脚本运行服务器

然后依次启动提供者和消费者项目，即可调用服务